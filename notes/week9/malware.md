# Malware

Stands for MALicious softWARE

- A set of instr that cause a system's security policy to be violated
	- To propagate/ install on target
	- to cause harm on target

## Different kinds of Malware:

There is some overlap, but it's helpful to understand these
- virus: Attaches itself to program and copies to other programs
	- use email/ infected media to propagate
- Trojan Horse: contains unexpected additional functionality
- Logic Bomb: Triggers action when conditions occur
- Time Bomb: Triggers action when a specified time occurs
- Trapdoor: Allows unauthorized access to functionality
- Rabbit: Replicates itself without limit to exhaust RSS
- Netbot: Trapdoor programs orchestrated through a control channel
- Root Kit: Hooks standard OS calls to hide data

## Worm: Propagates copies of itself through the a network.(self directed)
- propagate from one computer to another
- 1988 Cornell grad student was experimenting with self-propagating code
- ran it at MIT to mask Identity of cornell student
- Made a mistake in programming and lost control
- Dropped the internet as it existed, losses of 10 million
- Charged under 1986 computer Fraud and Abuse act
- is now a famous professor at MIT Robert T. Morris

### Penetration:
- A worm needs some vulnerability to get onto a computer
- there are many:
	- Auto-exec on usb sticks
	- Buffer overflows in internet services and applications
	- lack of checking inputs, SQL databases
	- Humans - executable urls, phishing, malicious website

### Propagation:
- From an infected host a worm can propagate
	- randomly, systematically, hitlist
	- look around local area for hosts with known vulnerabilities
	- can send messages that install malwaree
	-attache to files, storage, or phishing

### Worm Phases:
- Dormant
- Propagation
- Triggering
- Execution

### Who to target
- typically done through *scanning*
	- select random addresses, harder to do on IPV6
	- address space is huge
	- lets say 1/4 vulnerable windows machines on IPV4, total of 2^30
	- take the same number of machines and spread over IPV6,
	- now chance is 1 in 2^98 ~ 10^30 one in a billion trillion
- slammer worm: IPV4 network:
	- within 30 mins, all of use, and major chuncks of the rest of the world
- hitlist scanning (pre-prepared list of known vulnerable hosts)
- DNS searvhes, spiders (code red, crawls), listening to P2P networks
- permutation scanning( dividing up ip address space)
- Warhol Worm - hitlist + permutation

### Viruses and worms in IPV6
- pure viruses dont change in IPV6 but hybrid viruses and pure worm do
	- this isn't feasable as worms depend on scanning

### Network propagation
- send a small number of packets to reduce detection
- UDP packets
	- no ack needed, so it is easy to spoof source address
- connect to vulnerable network services
	- genneraly exercise buffer overflow
	- launch shell
		- running at high priv
		- use as foothold to gain priv
		- us as attack launch point
### Drive-by infections
- social engineering propagation
- Much malware installation (netbots) is caused by user instigated drive-by download
- visit infected website and accidentaly download software
- Dancing bunny e-cards from friends or strangers
- improved network control is reducing direct worm style network propagation

### worm Controls
- Signature based scan filtering -network controls can detect thsi
- filter based worm containment
- payload classification : packet analysis
- Threshold random walk: look for randomness in communication patterns to detect worm
- rate limiting the amount of scan lick traffic per host (when Identified, host is quarentined)


